import{_ as a,c as i,o as n,ag as e}from"./chunks/framework.BgId8OS5.js";const c=JSON.parse('{"title":"Создание и настройка комплитера","description":"","frontmatter":{},"headers":[],"relativePath":"ruRU/projbobcat/resourceCompleter/createAndConfigCompleter.md","filePath":"ruRU/projbobcat/resourceCompleter/createAndConfigCompleter.md","lastUpdated":1770208428000}'),l={name:"ruRU/projbobcat/resourceCompleter/createAndConfigCompleter.md"};function t(p,s,r,h,k,d){return n(),i("div",null,s[0]||(s[0]=[e(`<div style="display:none;" hidden="true" aria-hidden="true">Are you an LLM? You can read better optimized documentation at /ruRU/projbobcat/resourceCompleter/createAndConfigCompleter.md for this page in Markdown format</div><h1 id="создание-и-настроика-комплитера" tabindex="-1">Создание и настройка комплитера <a class="header-anchor" href="#создание-и-настроика-комплитера" aria-label="Permalink to &quot;Создание и настройка комплитера&quot;">​</a></h1><nav class="table-of-contents"><ul><li><a href="#создание-и-настроика-комплитера">Создание и настройка комплитера</a><ul><li><a href="#инициализация-комплитера">Инициализация комплитера</a></li><li><a href="#завершение-игровых-ресурсов">Завершение игровых ресурсов</a></li><li><a href="#отчет-о-ходе-выполнения">Отчет о ходе выполнения</a><ul><li><a href="#отчет-о-ходе-выполнения-проверки-ресурсов">Отчет о ходе выполнения проверки ресурсов</a></li><li><a href="#отчет-о-ходе-загрузки-фаилов-комплитером">Отчет о ходе загрузки файлов комплитером</a></li><li><a href="#отчет-об-информации-о-ходе-загружаемых-фаилов">Отчет об информации о ходе загружаемых файлов</a></li></ul></li></ul></li></ul></nav><h2 id="инициализация-комплитера" tabindex="-1">Инициализация комплитера <a class="header-anchor" href="#инициализация-комплитера" aria-label="Permalink to &quot;Инициализация комплитера&quot;">​</a></h2><p>Создать комплитер ресурсов очень просто, вам просто нужно использовать следующий код для завершения инициализации комплитера:</p><div class="language-c# vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c#</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> completer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DefaultResourceCompleter</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    MaxDegreeOfParallelism </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [MAX_DEGREE_OF_PARALLELISM],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ResourceInfoResolvers </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IResourceInfoResolver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        ..</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Инициализация распознавателей информации о ресурсах</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    TotalRetry </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [NUMBER_OF_TOTAL_RETRY],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    CheckFile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [CHECK_FILE_AFTER_DOWNLOADED],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    DownloadParts </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [TOTAL_DOWNLOAD_SEGMENTS_FOR_LARGE_FILE]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Руководства по инициализации распознавателей информации о ресурсах см. в разделе <a href="/ruRU/projbobcat/resourceCompleter/resourceInfoResolver/index">Распознаватели информации о ресурсах</a>.</p></div><p>В приведенном выше блоке кода замените эти параметры в соответствии с вашей реальной ситуацией:</p><table tabindex="0"><thead><tr><th style="text-align:center;">Элемент</th><th style="text-align:left;">Тип данных</th><th style="text-align:center;">Описание</th></tr></thead><tbody><tr><td style="text-align:center;">[MAX_DEGREE_OF_PARALLELISM]</td><td style="text-align:left;">INT</td><td style="text-align:center;">Степень параллелизма проверки ресурсов (количество одновременно проверяемых игровых ресурсов)</td></tr><tr><td style="text-align:center;">[CHECK_FILE_AFTER_DOWNLOADED]</td><td style="text-align:left;">BOOLEAN</td><td style="text-align:center;">Проверка целостности файла после его загрузки (если существует контрольная сумма ресурса)</td></tr><tr><td style="text-align:center;">[TOTAL_DOWNLOAD_SEGMENTS_FOR_LARGE_FILE]</td><td style="text-align:left;">INT</td><td style="text-align:center;">Количество сегментов для загрузки больших файлов</td></tr></tbody></table><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Значения <strong>[MAX_DEGREE_OF_PARALLELISM]</strong> и <strong>[TOTAL_DOWNLOAD_SEGMENTS_FOR_LARGE_FILE]</strong> следует настраивать в зависимости от производительности оборудования. Установка слишком больших значений может привести к снижению пропускной способности.</p></div><h2 id="завершение-игровых-ресурсов" tabindex="-1">Завершение игровых ресурсов <a class="header-anchor" href="#завершение-игровых-ресурсов" aria-label="Permalink to &quot;Завершение игровых ресурсов&quot;">​</a></h2><p>После завершения инициализации комплитера ресурсов вам нужно только вызвать метод завершения, чтобы начать операции проверки и завершения:</p><p>В асинхронном контексте используйте <strong>CheckAndDownloadTaskAsync</strong> для завершения установки:</p><div class="language-c# vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c#</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code" tabindex="0"><code><span class="line has-focus"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> completer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CheckAndDownloadTaskAsync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (result.TaskStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TaskResultStatus.Error </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (result.Value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.IsLibDownloadFailed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">??</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // После завершения комплитер ресурсов вернет результат выполнения.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Вы можете проверить значения свойств в result, чтобы определить, завершено ли завершение.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // IsLibDownloadFailed отражает, были ли успешно завершены необходимые для запуска библиотеки.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // В общем, если завершение файлов библиотек не удалось, это, скорее всего, приведет к сбою запуска игры.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>В синхронном контексте используйте <strong>CheckAndDownload</strong> для завершения установки:</p><div class="language-c# vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c#</span><pre class="shiki shiki-themes github-light github-dark has-focused-lines vp-code" tabindex="0"><code><span class="line has-focus"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> result</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> completer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CheckAndDownload</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="отчет-о-ходе-выполнения" tabindex="-1">Отчет о ходе выполнения <a class="header-anchor" href="#отчет-о-ходе-выполнения" aria-label="Permalink to &quot;Отчет о ходе выполнения&quot;">​</a></h2><p>В некоторых случаях комплитеру ресурсов может потребоваться несколько минут для завершения проверки и загрузки ресурсов. Поэтому вам может потребоваться сообщать пользователю о текущем ходе выполнения комплитера в режиме реального времени.</p><h3 id="отчет-о-ходе-выполнения-проверки-ресурсов" tabindex="-1">Отчет о ходе выполнения проверки ресурсов <a class="header-anchor" href="#отчет-о-ходе-выполнения-проверки-ресурсов" aria-label="Permalink to &quot;Отчет о ходе выполнения проверки ресурсов&quot;">​</a></h3><p>Вы можете получать ход проверки в режиме реального времени, зарегистрировав событие <strong>GameResourceInfoResolveStatus</strong>:</p><div class="language-c# vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c#</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">completer.GameResourceInfoResolveStatus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ReportProgress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args.Progress,  args.Status); };</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Где <strong>args.Progress</strong> указывает текущий процент выполнения проверки. <strong>args.Status</strong> — это текстовое описание текущего этапа проверки.</p><h3 id="отчет-о-ходе-загрузки-фаилов-комплитером" tabindex="-1">Отчет о ходе загрузки файлов комплитером <a class="header-anchor" href="#отчет-о-ходе-загрузки-фаилов-комплитером" aria-label="Permalink to &quot;Отчет о ходе загрузки файлов комплитером&quot;">​</a></h3><p>Вы можете получать ход проверки в режиме реального времени, зарегистрировав событие <strong>DownloadFileCompletedEvent</strong>:</p><div class="language-c# vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c#</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">completer.DownloadFileCompletedEvent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sender</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Параметр sender — это последний успешно загруженный файл комплитером, тип — DownloadFile.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // args возвращает статус загрузки этого файла (успешно/неудачно), а также счетчик повторных попыток файла,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // тип — DownloadFileCompletedEventArgs.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><ul><li><a href="https://github.com/Corona-Studio/ProjBobcat/blob/master/ProjBobcat/ProjBobcat/Class/Model/DownloadFile.cs" target="_blank" rel="noreferrer">Структура класса DownloadFile</a></li><li><a href="https://github.com/Corona-Studio/ProjBobcat/blob/master/ProjBobcat/ProjBobcat/Event/DownloadFileCompletedEventArgs.cs" target="_blank" rel="noreferrer">Структура события DownloadFileCompletedEventArgs</a></li></ul></div><h3 id="отчет-об-информации-о-ходе-загружаемых-фаилов" tabindex="-1">Отчет об информации о ходе загружаемых файлов <a class="header-anchor" href="#отчет-об-информации-о-ходе-загружаемых-фаилов" aria-label="Permalink to &quot;Отчет об информации о ходе загружаемых файлов&quot;">​</a></h3><p>Вы можете получать ход проверки в режиме реального времени, зарегистрировав событие <strong>DownloadFileChangedEvent</strong>:</p><div class="language-c# vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c#</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rC.DownloadFileChangedEvent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // args возвращает подробную информацию о загружаемом файле (полученные байты, общее количество байтов, текущая скорость, процент выполнения).</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // тип — DownloadFileChangedEventArgs.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><ul><li><a href="https://github.com/Corona-Studio/ProjBobcat/blob/master/ProjBobcat/ProjBobcat/Event/DownloadFileChangedEventArgs.cs" target="_blank" rel="noreferrer">Структура события DownloadFileChangedEventArgs</a></li></ul></div>`,30)]))}const E=a(l,[["render",t]]);export{c as __pageData,E as default};
